{% extends 'base.html' %}
{% load static %}

{% block 'content' %}
{% include 'includes/nav_bar.html' %}

<style>

/* Hide Radio button */
.rate > input{
  display: none;
}

.rate{
  display: inline-block;;
  border: 0;
}

.rate > label{
  float: right;
}

/* Showing the stars */
.rate > label:before{
  display: inline-block;
  font-size: 1.1rem;
  font-family: FontAwesome;
  content: "\f005";
  margin:0;
  padding:0.3rem .2rem;
  cursor: pointer;
}

/* Half star */
.rate .half:before{
  content: "\f089";
  position: absolute;
  padding-right: 0;
}

/* Click and hover */
input:checked ~ label, label:hover ~ label{
  color: #ffb503;
}

/* hover hightlight */
input:checked + label:hover, input:checked ~ label:hover,input:checked ~ label:hover ~ label,
label:hover ~ input:checked ~ label{
  color: #cc9000;
}

.rating-star i{
  color: #ffb503 !important;
}

ul.thumb{
  margin:0 auto;
  padding: 0;
  float: left;
}
ul.thumb li{
  list-style: none;
  margin: 10px;
}
ul.thumb li img{
  width: 80px;
  height: 80px;
  border: 1px solid grey;
}


</style>

    <p class="text-center">
        {% include 'includes/alerts.html' %}
    </p>

<section id="prodetails" class="section-p1 mt-0">
  <div class="single-pro-image">
    <div class="mainImage">
      <img src="{{ single_product.images.url }}"  width="100%" style="border-top-left-radius:25px;border-top-right-radius:25px;">
    </div>
    <div class="small-img-group mt-2">
      <div class="thumb" style="display: flex;flex-wrap: nowrap;justify-content: start;">
        <div class="px-1" style="width: 80px;">
          <a href="{{ single_product.images.url }}" class=""  target="mainImage"><img src="{{ single_product.images.url }}" class="small-img"  width="100%"></a>
        </div>
        {% for i in product_gallery %}
        <div class="px-1" style="width: 80px;">
          <a href="{{ i.image.url }}"  class=""  target="mainImage"><img src="{{ i.image.url }}"  class="small-img"  width="100%"></a>
        </div>
        {% endfor %}
      </div>
  </div>
  </div>
<div class="single-pro-details pt-0">

  <form action="{% url 'add_cart' single_product.id %}" method="post">
                    {% csrf_token %}
                <h6 class="mt-2">{{ single_product.category }} / {{ single_product.Product_name }}</h6>
                <h2 class="py-0 pt-3" style="font-size:2rem; font-weight:700; color:#088178;"> {{ single_product.Product_name }} </h2>

                <div class="rating-star">
                    <span>
                        <i class="fa fa-star{% if single_product.averageReview < 0.5 %}-o{% elif single_product.averageReview >= 0.5 and single_product.averageReview < 1 %}-half-o {% endif %}" aria-hidden="true"></i>
                        <i class="fa fa-star{% if single_product.averageReview < 1.5 %}-o{% elif single_product.averageReview >= 1.5 and single_product.averageReview < 2 %}-half-o {% endif %}" aria-hidden="true"></i>
                        <i class="fa fa-star{% if single_product.averageReview < 2.5 %}-o{% elif single_product.averageReview >= 2.5 and single_product.averageReview < 3 %}-half-o {% endif %}" aria-hidden="true"></i>
                        <i class="fa fa-star{% if single_product.averageReview < 3.5 %}-o{% elif single_product.averageReview >= 3.5 and single_product.averageReview < 4 %}-half-o {% endif %}" aria-hidden="true"></i>
                        <i class="fa fa-star{% if single_product.averageReview < 4.5 %}-o{% elif single_product.averageReview >= 4.5 and single_product.averageReview < 5 %}-half-o {% endif %}" aria-hidden="true"></i>
<!--  -->               <span style="font-size: 13px;" class="mx-3"> reviews: {{single_product.countReview}}</span>
                        </span>
                </div>
               
                <h2>$ {{ single_product.price }}</h2>  
                    {% if single_product.description == ''  %}     
                    {% else %}
                        <h4 class="p-0 ">Products DÃ©tails </h4>
                        <span> {{ single_product.description }}</span> 
                    {% endif %}
                    <div class="row mt-3">
                        <div class="col">
                            <div style="display: flex;">
                                <div>
                                    <select name="color" >
                                        <option disabled selected>color</option>
                                        {% for i in single_product.variation_set.colors %}
                                        <option value="{{i.variation_value }}">{{i.variation_value}}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <div class="px-2">
                                    <select name="size">
                                        <option disabled selected>size</option>
                                        {% for i in single_product.variation_set.sizes %}
                                        <option value="{{i.variation_value}}">{{i.variation_value}}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% if single_product.stock < 0 %}
                    <h4  disabled class="normal" style="color: red;">Out of stock</h4> 
                   
                    {% else %}
                        {% if in_cart %}
                        <i style="color: green; font-size: 25px;" class="fa fa-check" aria-hidden="true"> <span style="font-size: 12px;">Added to the cart</span></i>
                        <a href="{% url 'cart' %}"><button class="normal" style="background-color: white; color: black;  border: black;"><i class="bi-eye" aria-hidden="true"> check</i></button> </a>     
                        {% else %}
                        <button class="normal" type="submit">Add To Cart</button>
                        {% endif %}
        
                    {% endif %}
  </form>

</div>

</section>


<div class="container-fluid">
    <section id="form-details" style="padding: 20px; border: 0px; margin: 0px;">
        <form action="{% url 'submit_review' single_product.id %}" method="POST" class="row">
            {% csrf_token %}
            <h5 style="font-weight: 800;color: #088178;">Write Yours Reviews</h5>

            <label>How do you rate this product?</label>
            <br>
            <div class="rate">
                <input type="radio" name="rating" id="rating10" value="5" style="float: left;" required /><label for="rating10" title="5"></label>
                <input type="radio" name="rating" id="rating9" value="4.5" style="float: left;" required /><label for="rating9" title="4.5" class="half"></label>
                <input type="radio" name="rating" id="rating8" value="4" style="float: left;" required /><label for="rating8" title="4"></label>
                <input type="radio" name="rating" id="rating7" value="3.5" style="float: left;" required /><label for="rating7" title="3.5" class="half"></label>
                <input type="radio" name="rating" id="rating6" value="3" style="float: left;" required /><label for="rating6" title="3"></label>
                <input type="radio" name="rating" id="rating5" value="2.5" style="float: left;" required /><label for="rating5" title="2.5" class="half"></label>
                <input type="radio" name="rating" id="rating4" value="2" style="float: left;" required /><label for="rating4" title="2"></label>
                <input type="radio" name="rating" id="rating3" value="1.5" style="float: left;" required /><label for="rating3" title="1.5" class="half"></label>
                <input type="radio" name="rating" id="rating2" value="1" style="float: left;" required /><label for="rating2" title="1"></label>
                <input type="radio" name="rating" id="rating1" value="0.5" style="float: left;" required /><label for="rating1" title="0.5" class="half"></label>
            </div>

            <h5 style="font-weight: 800;color: #088178; font-size:16px;" class="mt-2">Reviews Title:</h5>
            <input type="text" placeholder="subject" name="subject" >
            <h5 style="font-weight: 800;color: #088178; font-size:16px;" class="mt-2">Reviews:</h5>
            <textarea id="" cols="10" rows="2" placeholder="Votre Message" name="review" ></textarea>
			{% if user.is_authenticated %}
                <button class="normal" type="submit" value="Submit Review">Send<i class="bi bi-send" style="float:right;"></i></button> 
            {% else %}
            
            <p>You must be logged in to post a review.</p>
            <a href="{% url 'login' %}"><div class="normal" style="width: 100%;" >Login now</div></a>
            {% endif %}
        </form>
    </section>
    <div class="col-12 col-md-6  mt-2">
        <h3  style="font-weight: 800;color: #088178;" class="p-3">Costumer Reviews</h3>
        <div class="rating-star mb-5"  style="align-self: flex-start">
            <span style="padding-left: 20px;" >
                <i class="fa fa-star{% if single_product.averageReview < 0.5 %}-o{% elif single_product.averageReview >= 0.5 and single_product.averageReview < 1 %}-half-o {% endif %}" aria-hidden="true"></i>
                <i class="fa fa-star{% if single_product.averageReview < 1.5 %}-o{% elif single_product.averageReview >= 1.5 and single_product.averageReview < 2 %}-half-o {% endif %}" aria-hidden="true"></i>
                <i class="fa fa-star{% if single_product.averageReview < 2.5 %}-o{% elif single_product.averageReview >= 2.5 and single_product.averageReview < 3 %}-half-o {% endif %}" aria-hidden="true"></i>
                <i class="fa fa-star{% if single_product.averageReview < 3.5 %}-o{% elif single_product.averageReview >= 3.5 and single_product.averageReview < 4 %}-half-o {% endif %}" aria-hidden="true"></i>
                <i class="fa fa-star{% if single_product.averageReview < 4.5 %}-o{% elif single_product.averageReview >= 4.5 and single_product.averageReview < 5 %}-half-o {% endif %}" aria-hidden="true"></i>
<!--  -->       <span style="font-size: 13px;" class="mx-3"> reviews: {{single_product.countReview}}</span>
            </span>
        </div>
        {% for review in reviews %}
        <div class="container mt-3">
            <div class="media p-2 pt-0 row">
              <div class="col-10">
                <div class="media-body">
                    <div class="row">
                        <div class="col-6" style="margin-top: 17px;">
                            <h4>{{review.user.full_name}}</h4>
                        </div>
                        <div class="col-6">
                            <h6 style="text-align: end; font-weight: 300;">Posted on {{review.updated_at}}</h6>
                        </div>
                    </div>
                  </div>
              </div>
              <div class="mt-3 row">
                <h6>{{review.subject}}</h6>
                <div class="rating-star">
                    <span>
                        <i class="fa fa-star{% if review.rating == 0.5 %}-half-o{% elif review.rating < 1 %}-o {% endif %}" aria-hidden="true"></i>
                        <i class="fa fa-star{% if review.rating == 1.5 %}-half-o{% elif review.rating < 2 %}-o {% endif %}" aria-hidden="true"></i>
                        <i class="fa fa-star{% if review.rating == 2.5 %}-half-o{% elif review.rating < 3 %}-o {% endif %}" aria-hidden="true"></i>
                        <i class="fa fa-star{% if review.rating == 3.5 %}-half-o{% elif review.rating < 4 %}-o {% endif %}" aria-hidden="true"></i>
                        <i class="fa fa-star{% if review.rating == 4.5 %}-half-o{% elif review.rating < 5 %}-o {% endif %}" aria-hidden="true"></i>
                    </span>
                </div> 
                <div class="col-6">
                <p>
                    {{review.review}}
                </p>
                </div>
            </div> 
            </div>
        </div>
        {% endfor %}
    </div>
</div>


<section id="product1" class="section-p1">
    <h2>Autres Produits</h2>
    <p>Summer Collection New Mordem Design</p>
    <div class="pro-container">
        {% for product in otherproduct %}
        <div class="pro" onclick="window.location.href='{{product.get_url}}';">
        <img src="{{product.images.url}}" alt="{{product.slug}}"> 
        <div class="des">
            <span>{{product.category}}</span> 
            <h5>{{product.Product_name}}</h5>
            <div class="star">
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
            </div>
            <h4>${{product.price}}</h4>
        </div>
        <a href="{% url 'add_cart' product.id %}"><i class="bi bi-bag cart"></i></a>
        </div>
        {% endfor %}

    </div>
</section>

{% include 'includes/footer.html' %}
{% endblock %}